---
title: AVG剧情编辑器
tags: Work Tools

---

使用项目： 《永恒的七日之都》

2020年 6月 - 2020年 8月

## 解决问题

之前剧情：

文案初稿: word  --> 手动填入 导表数据文案
导表数据: excel 文案基础上，填一些指令和词语
人物模型等也是用excel来读取对应内容生成对应参数

目标方案：

模拟橙光编辑器, 结合Nexo引擎和一些api接口, 做一个实时剧情编辑工具


## 实际方案

时间跨度比较久，并且细节文档并没有记录，有所遗忘

前提：引擎按照导入的excel生成对应的py, 其内容按照字典格式进行读取

1. word 转 py / excel
文案策划的word是按照规定格式写的，转成excel/py的方式时，做了空白剔除，关键词匹配并转化参数，划分章节等文字处理，excel只是做为中间层，方便一些老文案过渡使用，最终还是要转为py

2. 导入引擎
上述py是按照特定格式生成的，引擎能够直接读取并生成游戏中对应的文本，做了文本快速填充功能，从历史excel文案中， 筛选出了所有涉及的指令词条，并手动配置了相关选项

例如 smile an 2, 词条代表，安（人物），第二种笑容（大笑），引擎会读入词条内容，模型会表现出an的笑容，当然这里面也会见检查是否属于当前模型（这里之前一致有策划填错）

3. 资源分类和导入
类似橙光编辑器，其立绘，模型，背景，音效等资源都是可以编辑器内使用的，用法和上述例子类似，放在关键字下面即可

4. 新建，保存，撤销，向前等功能
都是一些比较通用的功能，按照特定格式新建，多种格式保存，所有操作存入一个队列可进行回退操作或者取消回退操作等

多分支节点问题：本来想做成sunshine拉线那种, 替换掉当前可视化方案， 但是碍于时间放弃


## 最终效果

拿了个新人奖, 后其他人迭代了一些, 直到关服 (sad) 前都备受好评的使用

永7真的是个好游戏, 当时就提出UGC的案例, 可惜被文案策划老大否了(法务问题!!)



## 前辈的可视化方案

随着手游市场竞争愈发激烈，向端游借鉴成熟的玩法系统、寻找一个细分市场成了很多项目的不二秘诀。G58也不例外，在传统副本战斗的基础上，融入了日式AVG的剧情系统作为主要玩法之一，于两次测试之中收获了大量二次元玩家好评(和吐槽)。这一剧情系统中，事件分支错综复杂，牵扯玩法众多，表格结构庞大，测试耗时较长。如何帮策划在填表时理清思绪？如何为QA的测试提供参考？这里为大家介绍一下G58在剧情测试中的一点探索：

> 利用python+graphviz将表格内容可视化的测试思路。

本文分三个部分：

1.介绍G58剧情系统，开发/测试中遇到的问题、以及尝试解决时的思索；

2.安利一个非常强大的流程图制作工具graphviz，并给出简单例子；

3.如何将复杂的剧情逻辑，抽象成树形结构，并画成流程图。这一部分耗费了工具开发95%的时间，但是和G58业务逻辑绑定很深，不一定适用于所有项目，因此主要是介绍一下制作时的思路与爬过的坑供大家围观。
